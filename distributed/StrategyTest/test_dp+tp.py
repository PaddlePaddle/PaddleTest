#!/bin/env python3
# -*- coding: utf-8 -*-
# @author DDDivano
# encoding=utf-8 vi:ts=4:sw=4:expandtab:ft=python


from dist_tester import Runner

def test_2dp_4tp_mnist():
    """
    2 dp 4 tp
    """
    expect = {'gpu0': [2.640113353729248, 0.9688692092895508, 1.5502188205718994], 'gpu1': [2.653158187866211, 2.4070043563842773, 2.3094840049743652], 'gpu2': [2.3844339847564697, 2.371854782104492, 2.297410249710083], 'gpu3': [2.460557699203491, 2.360544204711914, 2.311518669128418], 'gpu4': [2.6325669288635254, 0.9487365484237671, 1.7677562236785889], 'gpu5': [2.4855175018310547, 2.154111623764038, 2.343071222305298], 'gpu6': [2.5523641109466553, 2.403956174850464, 2.423933267593384], 'gpu7': [2.6419405937194824, 2.3523285388946533, 2.3571197986602783]}
    r = Runner(case_file="dist_SimpleNet_2DP+4TP.py", gpus="0,1,2,3,4,5,6,7", expect=expect)
    r.run()


def test_2dp_2tp_mnist():
    """
    2 dp 2 tp
    """
    expect = {'gpu0': [2.3705811500549316, 0.9170342683792114, 1.1656371355056763, 1.0103193521499634, 1.081994652748108], 'gpu1': [2.48694109916687, 2.448245048522949, 2.3579564094543457, 2.301237106323242, 2.2867512702941895], 'gpu2': [2.3643109798431396, 1.1874860525131226, 0.8270002007484436, 0.9013262987136841, 1.243064522743225], 'gpu3': [2.4793944358825684, 2.4847326278686523, 2.330138683319092, 2.38385009765625, 2.3211264610290527]}
    r = Runner(case_file="dist_SimpleNet_2DP+2TP.py", gpus="0,1,2,3", expect=expect)
    r.run()

